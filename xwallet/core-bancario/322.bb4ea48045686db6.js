"use strict";(self.webpackChunkCoreBancario=self.webpackChunkCoreBancario||[]).push([[322],{3322:(G,h,s)=>{s.r(h),s.d(h,{AccountModule:()=>L});var p=s(9808),t=s(4893),a=s(2382),b=s(520),M=s(452);let g=(()=>{class e{constructor(n,o){this.httpClient=n,this.settingsService=o}getAccounts(){return this.httpClient.get(`${this.settingsService.api}api/v1/accounts`)}getAccount({accountId:n}){return this.httpClient.get(`${this.settingsService.api}api/v1/accounts/${n}`)}setAccount({account:n,customerId:o}){if(n)return this.httpClient.post(`${this.settingsService.api}api/v1/accounts`,{customerId:o,accountBalance:n.accountBalance,accountType:n.accountType,accountCurrency:n.accountCurrency});throw new Error(JSON.stringify({titulo:"Error Account",message:"Account debe tener un valor."}))}deleteAccount({accountId:n}){return this.httpClient.delete(`${this.settingsService.api}api/v1/accounts/${n}`)}updateAccount({account:n}){if(n)return this.httpClient.put(`${this.settingsService.api}api/v1/accounts/${n.accountId}`,n);throw new Error(JSON.stringify({titulo:"Error Account",message:"Account debe tener un valor."}))}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(b.eN),t.LFG(M.g))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac}),e})();var S=s(1813),_=s(2587),C=s(2664);let v=(()=>{class e{constructor(n){this.httpClient=n}getCurrencies(){return this.httpClient.get("assets/server/currency.json")}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(b.eN))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac}),e})(),T=(()=>{class e{constructor(n){this.httpClient=n}getAccountsType(){return this.httpClient.get("assets/server/accountType.json")}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(b.eN))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac}),e})();function w(e,i){if(1&e&&(t.TgZ(0,"option",19),t._uU(1),t.qZA()),2&e){const n=i.$implicit;t.Q6J("value",n.Descripcion),t.xp6(1),t.hij(" ",n.Descripcion," ")}}function I(e,i){if(1&e){const n=t.EpF();t.TgZ(0,"button",20),t.NdJ("click",function(c){return t.CHM(n),t.oxw().clearAccountType(c)}),t._UZ(1,"i",21),t.qZA()}}function O(e,i){if(1&e&&(t.TgZ(0,"option",19),t._uU(1),t.qZA()),2&e){const n=i.$implicit;t.Q6J("value",n.Descripcion),t.xp6(1),t.hij(" ",n.Descripcion," ")}}function P(e,i){if(1&e){const n=t.EpF();t.TgZ(0,"button",20),t.NdJ("click",function(c){return t.CHM(n),t.oxw().clear(c)}),t._UZ(1,"i",21),t.qZA()}}function U(e,i){if(1&e){const n=t.EpF();t.TgZ(0,"li",22)(1,"button",23),t.NdJ("click",function(){return t.CHM(n),t.oxw().closeForm()}),t._uU(2," Cerrar "),t.qZA()()}}function k(e,i){if(1&e){const n=t.EpF();t.TgZ(0,"li",22)(1,"button",23),t.NdJ("click",function(){return t.CHM(n),t.oxw().closeForm()}),t._uU(2," Cancelar "),t.qZA()()}}function F(e,i){1&e&&(t.TgZ(0,"li",22)(1,"button",24),t._uU(2,"Guardar"),t.qZA()())}var l=(()=>{return(e=l||(l={}))[e.Alta=0]="Alta",e[e.Modificacion=1]="Modificacion",e[e.Detalle=2]="Detalle",l;var e})();let m=(()=>{class e{constructor(n,o,c,r,u,d,f){this.fb=n,this.accountService=o,this.modalActivoRef=c,this.dialogService=r,this.dataService=u,this.currencyService=d,this.accountTypeService=f,this.estado=l.Detalle,this.titulo="",this.currencies=[],this.accountsType=[],this.grupoAccount=this.fb.group({accountId:[0],accountBalance:[0],accountType:[],accountCurrency:[]})}ngOnInit(){this.getCurrencies(),this.getAccountsType(),this.estado!==l.Alta&&(this.cargarPantalla(),this.estado===l.Detalle&&this.grupoAccount.disable())}getCurrencies(){this.currencyService.getCurrencies().subscribe(n=>{this.currencies=n})}getAccountsType(){this.accountTypeService.getAccountsType().subscribe(n=>{this.accountsType=n})}onSubmit(){if(this.grupoAccount.valid)if(this.account=this.grupoAccount.value,this.estado===l.Alta)this.accountService.setAccount({account:this.account,customerId:this.dataService.currentCustomer.customerId}).subscribe({next:n=>{console.log(n),this.closeForm(),this.dialogService.open({title:"Cuenta creada",message:"La cuenta se ha creado correctamente",tipo:"exito",confirmText:"Aceptar",cancelText:void 0})},error:n=>{console.log(n)}});else{let n={title:"Modificar cuenta",message:"\xbfEst\xe1 seguro que desea modificar la cuenta seleccionada?",tipo:"advertencia",confirmText:"Aceptar",cancelText:"Cancelar"};this.dialogService.open(n).then(o=>{this.accountService.updateAccount({account:this.account,customerId:this.dataService.currentCustomer.customerId}).subscribe({next:c=>{console.log(c),this.closeForm(),n={title:"Cuenta modificada",message:"La cuenta se ha modificado correctamente",tipo:"exito",confirmText:"Aceptar",cancelText:void 0},this.dialogService.open(n)},error:c=>{console.log(c)}})})}}cargarPantalla(){this.account&&this.grupoAccount.patchValue(this.account)}clear(n){n.stopPropagation(),this.grupoAccount.controls.accountCurrency.setValue(null)}clearAccountType(n){n.stopPropagation(),this.grupoAccount.controls.accountType.setValue(null)}closeForm(){this.account=null,this.modalActivoRef.cerrar()}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(a.qu),t.Y36(g),t.Y36(S.W),t.Y36(_.x),t.Y36(C.D),t.Y36(v),t.Y36(T))},e.\u0275cmp=t.Xpm({type:e,selectors:[["cb-ingreso-modificacion"]],decls:34,vars:10,consts:[[1,"cb-main",3,"formGroup","ngSubmit"],[1,"cb-header"],[1,"cb-btn__icon","cb-icon","cb-header__title",2,"margin-right","0.5rem",3,"ngClass"],[1,"cb-header__title",2,"width","100%","text-wrap","nowrap","margin-top","0.1rem"],[1,"cb-section","cb-section--form","cb-form",2,"display","flex","flex-direction","column","row-gap","8px"],[1,"cb-form__section","form-section"],[1,"form-section__content",2,"display","flex","flex-direction","row","flex-wrap","wrap"],[1,"cb-form-field","cb-form-field--inline"],[1,"cb-form-field__label"],["type","text","formControlName","accountBalance",1,"cb-form-field__input","cb-input","cb-input--small"],[1,"cb-input-group"],["formControlName","accountType",1,"cb-input-group__input","cb-input",2,"height","22px"],[3,"value",4,"ngFor","ngForOf"],["type","button","class","cb-input-group__icon cb-btn","style","cursor: pointer;",3,"click",4,"ngIf"],["formControlName","accountCurrency",1,"cb-input-group__input","cb-input",2,"height","22px"],[1,"cb-footer","cb-footer--sticky"],[1,"cb-footer__toolbar","cb-toolbar"],[1,"cb-toolbar__content-fixed"],["class","cb-toolbar__option",4,"ngIf"],[3,"value"],["type","button",1,"cb-input-group__icon","cb-btn",2,"cursor","pointer",3,"click"],[1,"cb-btn__icon","cb-icon","cb-icon--cross"],[1,"cb-toolbar__option"],["type","button",1,"btn","cb-btn","cb-btn--secondary",3,"click"],["type","submit",1,"btn","cb-btn"]],template:function(n,o){if(1&n&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return o.onSubmit()}),t.TgZ(1,"header",1),t._UZ(2,"i",2),t.TgZ(3,"h1",3),t._uU(4),t.qZA()(),t.TgZ(5,"section",4)(6,"fieldset",5)(7,"div",6)(8,"div",7)(9,"label",8),t._uU(10,"Balance"),t.qZA(),t._UZ(11,"input",9),t.qZA()(),t.TgZ(12,"div",6)(13,"div",7)(14,"label",8),t._uU(15,"Tipo"),t.qZA(),t.TgZ(16,"div",10)(17,"select",11),t.YNc(18,w,2,2,"option",12),t.qZA(),t.YNc(19,I,2,0,"button",13),t.qZA()()(),t.TgZ(20,"div",6)(21,"div",7)(22,"label",8),t._uU(23,"Moneda"),t.qZA(),t.TgZ(24,"div",10)(25,"select",14),t.YNc(26,O,2,2,"option",12),t.qZA(),t.YNc(27,P,2,0,"button",13),t.qZA()()()()(),t.TgZ(28,"footer",15)(29,"div",16)(30,"div",17),t.YNc(31,U,3,0,"li",18),t.YNc(32,k,3,0,"li",18),t.YNc(33,F,3,0,"li",18),t.qZA()()()()),2&n){let c,r;t.Q6J("formGroup",o.grupoAccount),t.xp6(2),t.Q6J("ngClass",2===o.estado?"cb-icon--info":1===o.estado?"cb-icon--edit":"cb-icon--add"),t.xp6(2),t.Oqu(o.titulo),t.xp6(14),t.Q6J("ngForOf",o.accountsType),t.xp6(1),t.Q6J("ngIf",(null==(c=o.grupoAccount.get("accountType"))?null:c.value)&&!(null!=(c=o.grupoAccount.get("accountType"))&&c.disabled)),t.xp6(7),t.Q6J("ngForOf",o.currencies),t.xp6(1),t.Q6J("ngIf",(null==(r=o.grupoAccount.get("accountCurrency"))?null:r.value)&&!(null!=(r=o.grupoAccount.get("accountCurrency"))&&r.disabled)),t.xp6(4),t.Q6J("ngIf",2===o.estado),t.xp6(1),t.Q6J("ngIf",2!==o.estado),t.xp6(1),t.Q6J("ngIf",2!==o.estado)}},directives:[a._Y,a.JL,a.sg,p.mk,a.Fj,a.JJ,a.u,a.EJ,p.sg,a.YN,a.Kr,p.O5],styles:[".cb-form-field[_ngcontent-%COMP%]{margin-bottom:8px;width:100%}.cb-form-field__input[_ngcontent-%COMP%]{flex-grow:1}.cb-footer[_ngcontent-%COMP%]{width:88%}"]}),e})();var y=s(3149),A=s(4591);const J=["boton"],q=["menu"],N=function(e){return{visibility:e}},Y=["*"];let D=(()=>{class e{constructor(n){this.elementRef=n,this.showMenu=!1}ngAfterViewInit(){this.menuRef.nativeElement.querySelectorAll("li").forEach(o=>{o.addEventListener("click",()=>{this.showMenu=!1})})}toggleContent(){const n=!this.showMenu;if(n){const o=this.menuRef.nativeElement.offsetWidth,c=this.menuRef.nativeElement.offsetHeight,r=this.botonRef.nativeElement.getBoundingClientRect(),u=r.top,d=r.left,f=window.innerWidth,j=window.innerHeight;let Z=d+20;d+o>f&&(Z=d-o);let x=u+20;u+c>j&&(x=u-c),this.menuRef.nativeElement.style.top=x+"px",this.menuRef.nativeElement.style.left=Z+"px"}this.showMenu=n}onDocumentClick(n){var o,c;null!==(c=null===(o=this.elementRef)||void 0===o?void 0:o.nativeElement.contains(n.target))&&void 0!==c&&c||(this.showMenu=!1)}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(t.SBq))},e.\u0275cmp=t.Xpm({type:e,selectors:[["cb-dropdown"]],viewQuery:function(n,o){if(1&n&&(t.Gf(J,7),t.Gf(q,7)),2&n){let c;t.iGM(c=t.CRH())&&(o.botonRef=c.first),t.iGM(c=t.CRH())&&(o.menuRef=c.first)}},hostBindings:function(n,o){1&n&&t.NdJ("click",function(r){return o.onDocumentClick(r)},!1,t.evT)},ngContentSelectors:Y,decls:6,vars:3,consts:[["id","boton","type","button",1,"cb-btn","cb-btn--only-icon",2,"border","none","background-color","transparent","cursor","pointer",3,"click"],["boton",""],[1,"cb-btn__icon","cb-icon","cb-icon--dropdown"],["id","menu",3,"ngStyle"],["menu",""]],template:function(n,o){1&n&&(t.F$t(),t.TgZ(0,"button",0,1),t.NdJ("click",function(){return o.toggleContent()}),t._UZ(2,"i",2),t.qZA(),t.TgZ(3,"div",3,4),t.Hsn(5),t.qZA()),2&n&&(t.xp6(3),t.Q6J("ngStyle",t.VKq(1,N,o.showMenu?"visible":"hidden")))},directives:[p.PC],styles:["#menu[_ngcontent-%COMP%]{position:fixed;top:0;left:0;z-index:99999;visibility:hidden}#menu[_ngcontent-%COMP%]   .visible[_ngcontent-%COMP%]{visibility:visible}"]}),e})();function E(e,i){if(1&e){const n=t.EpF();t.TgZ(0,"tr",10)(1,"td",14)(2,"cb-dropdown",15)(3,"ul",16)(4,"li",17),t.NdJ("click",function(){const r=t.CHM(n).$implicit;return t.oxw().verAccount(r)}),t._UZ(5,"span",18),t.TgZ(6,"p",19),t._uU(7,"Ver"),t.qZA()(),t.TgZ(8,"li",17),t.NdJ("click",function(){const r=t.CHM(n).$implicit;return t.oxw().editarAccount(r)}),t._UZ(9,"span",20),t.TgZ(10,"p",19),t._uU(11,"Editar"),t.qZA()(),t.TgZ(12,"li",17),t.NdJ("click",function(){const r=t.CHM(n).$implicit;return t.oxw().eliminarAccount(r)}),t._UZ(13,"span",21),t.TgZ(14,"p",19),t._uU(15,"Eliminar"),t.qZA()(),t.TgZ(16,"li",22),t._UZ(17,"span",23),t.TgZ(18,"p",19),t._uU(19,"Movimiento"),t.qZA(),t.TgZ(20,"ul",24)(21,"li",25),t._UZ(22,"span",26),t.TgZ(23,"p",27),t._uU(24,"Intercambio"),t.qZA()(),t.TgZ(25,"li",25),t._UZ(26,"span",28),t.TgZ(27,"p",27),t._uU(28,"Inversi\xf3n"),t.qZA()(),t.TgZ(29,"li",25),t._UZ(30,"span",29),t.TgZ(31,"p",27),t._uU(32,"Transacciones"),t.qZA()(),t.TgZ(33,"li",25),t._UZ(34,"span",30),t.TgZ(35,"p",27),t._uU(36,"Transferencia"),t.qZA()()()()()()(),t.TgZ(37,"td",14),t._uU(38),t.qZA(),t.TgZ(39,"td",14),t._uU(40),t.qZA(),t.TgZ(41,"td",14),t._uU(42),t.qZA()()}if(2&e){const n=i.$implicit;t.xp6(38),t.hij(" ",n.accountBalance," "),t.xp6(2),t.hij(" ",n.accountType," "),t.xp6(2),t.hij(" ",n.accountCurrency," ")}}let R=(()=>{class e{constructor(n,o,c,r,u){this.accountService=n,this.customerService=o,this.modalService=c,this.dialogService=r,this.dataService=u,this.accounts=[],this.activeSubmenuIndex=null}ngOnInit(){this.getAccounts()}getAccounts(){this.accountService.getAccounts().subscribe(n=>{this.accounts=n.filter(o=>{var c;return null===(c=this.dataService.currentCustomer)||void 0===c?void 0:c.accountList.some(r=>r.accountId===o.accountId)})})}getCustomer(){this.customerService.getCustomer({customerId:this.dataService.currentCustomer.customerId}).subscribe(n=>{this.dataService.changeData(n),this.getAccounts()})}verAccount(n){const o=this.modalService.abrir(m,{cerrarConClickFueraDelModal:!1});o.instancia.account=n,o.instancia.titulo="Detalle: "+n.accountType}editarAccount(n){const o=this.modalService.abrir(m,{cerrarConClickFueraDelModal:!1});o.instancia.account=n,o.instancia.estado=1,o.instancia.titulo="Modificaci\xf3n: "+n.accountType,o.respuesta$.subscribe({next:()=>{},error:()=>{this.getCustomer()}})}altaAccount(){const n=this.modalService.abrir(m,{cerrarConClickFueraDelModal:!1});n.instancia.estado=0,n.instancia.titulo="Alta",n.respuesta$.subscribe({next:()=>{},error:()=>{this.getCustomer()}})}eliminarAccount(n){let o={title:"Eliminar cuenta",message:"\xbfEst\xe1 seguro que desea eliminar la cuenta seleccionada?",tipo:"advertencia",confirmText:"Aceptar",cancelText:"Cancelar"};this.dialogService.open(o).then(c=>{c&&this.accountService.deleteAccount({accountId:n.accountId}).subscribe({next:()=>{o={title:"Cuenta eliminada",message:"La cuenta seleccionada ha sido eliminada correctamente.",tipo:"exito",confirmText:"Aceptar",cancelText:void 0},this.dialogService.open(o),this.getCustomer()},error:()=>{}})})}toggleSubmenu(n){this.activeSubmenuIndex=this.activeSubmenuIndex===n?null:n}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(g),t.Y36(y.v),t.Y36(A.Z),t.Y36(_.x),t.Y36(C.D))},e.\u0275cmp=t.Xpm({type:e,selectors:[["cb-consulta"]],decls:21,vars:1,consts:[[1,"cb-main"],[1,"body-elements-container"],[1,"cb-header",2,"display","flex","align-items","center","justify-content","space-between"],[1,"cb-header__title"],[2,"display","flex","gap","5px"],[1,"btn","cb-btn","cb-btn--only-icon",2,"color","#9d9d9d","background-color","transparent",3,"click"],[1,"fas","fa-plus"],[1,"cb-section","cb-section--table"],[1,"cb-table","cb-table--responsive"],[1,"cb-table__head","cb-table__head--only-desk"],[1,"cb-table__tr"],[1,"cb-table__th"],[1,"cb-table__body"],["class","cb-table__tr",4,"ngFor","ngForOf"],[1,"cb-table__td","cb-table__td--center","cb-table__td--only-desk"],[1,"on-hover-visible"],[1,"cb-menu"],[1,"cb-menu__option",3,"click"],[1,"cb-menu__icon","cb-icon","cb-icon--info"],[1,"cb-menu__title"],[1,"cb-menu__icon","cb-icon","cb-icon--edit"],[1,"cb-menu__icon","cb-icon","cb-icon--delete"],[1,"cb-menu__option","cb-menu__option--has-submenu"],[1,"cb-menu__icon","cb-icon","cb-icon--movement"],[1,"cb-submenu"],[1,"cb-submenu__option"],[1,"cb-submenu__icon","cb-icon","cb-icon--exchange"],[1,"cb-submenu__title"],[1,"cb-submenu__icon","cb-icon","cb-icon--investment"],[1,"cb-submenu__icon","cb-icon","cb-icon--transaction"],[1,"cb-submenu__icon","cb-icon","cb-icon--transfer"]],template:function(n,o){1&n&&(t.TgZ(0,"form",0)(1,"div",1)(2,"header",2)(3,"h1",3),t._uU(4,"Datos Personales"),t.qZA(),t.TgZ(5,"div",4)(6,"button",5),t.NdJ("click",function(){return o.altaAccount()}),t._UZ(7,"i",6),t.qZA()()()(),t.TgZ(8,"section",7)(9,"table",8)(10,"thead",9)(11,"tr",10),t._UZ(12,"th",11),t.TgZ(13,"th",11),t._uU(14," Balance "),t.qZA(),t.TgZ(15,"th",11),t._uU(16," Tipo "),t.qZA(),t.TgZ(17,"th",11),t._uU(18," Moneda "),t.qZA()()(),t.TgZ(19,"tbody",12),t.YNc(20,E,43,3,"tr",13),t.qZA()()()()),2&n&&(t.xp6(20),t.Q6J("ngForOf",o.accounts))},directives:[a._Y,a.JL,a.F,p.sg,D],styles:['@charset "UTF-8";[_nghost-%COMP%]   .on-hover-visible[_ngcontent-%COMP%]{display:flex;justify-content:center;width:100%}[_nghost-%COMP%]   .cb-menu__option[_ngcontent-%COMP%]{position:relative;padding:10px}[_nghost-%COMP%]   .cb-submenu[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0;position:absolute;top:0;left:100%;display:none;background-color:#fff;border:1px solid #ccc;box-shadow:0 1px 2px #0003;z-index:1000}[_nghost-%COMP%]   .cb-menu__option--has-submenu[_ngcontent-%COMP%]:hover   .cb-submenu[_ngcontent-%COMP%]{display:block}[_nghost-%COMP%]   .cb-submenu__option[_ngcontent-%COMP%]:hover{background-color:#f0f0f0}[_nghost-%COMP%]   .cb-submenu__option[_ngcontent-%COMP%]{padding:7px;cursor:pointer;display:flex;align-items:center}[_nghost-%COMP%]   x[_ngcontent-%COMP%]   .cb-submenu__option[_ngcontent-%COMP%]:hover{background-color:#f0f0f0}[_nghost-%COMP%]   .cb-submenu__title[_ngcontent-%COMP%]{margin:0;padding:5px 10px;cursor:pointer;color:#646464;font-weight:600}[_nghost-%COMP%]   .cb-submenu__icon[_ngcontent-%COMP%]{margin-right:5px;flex-shrink:0}[_nghost-%COMP%]   .cb-icon--movement[_ngcontent-%COMP%]{width:20px!important}[_nghost-%COMP%]   .cb-icon--exchange[_ngcontent-%COMP%], [_nghost-%COMP%]   .cb-icon--investment[_ngcontent-%COMP%], [_nghost-%COMP%]   .cb-icon--transaction[_ngcontent-%COMP%], [_nghost-%COMP%]   .cb-icon--transfer[_ngcontent-%COMP%]{width:22px!important}']}),e})();var B=s(8753),H=s(6211),$=s(1285);const Q=[{path:"consulta",component:R}];let L=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({providers:[g,y.v,v,T,A.Z,_.x],imports:[[p.ez,a.u5,a.UX,b.JF,B.Bz.forChild(Q),H.s,$.e]]}),e})()}}]);