"use strict";(self.webpackChunkCoreBancario=self.webpackChunkCoreBancario||[]).push([[109],{1109:(q,b,s)=>{s.r(b),s.d(b,{CustomerModule:()=>J});var u=s(9808),t=s(4893),l=s(2382),d=s(3149),C=s(1813),m=s(2587);function h(n,c){if(1&n){const e=t.EpF();t.TgZ(0,"li",18)(1,"button",19),t.NdJ("click",function(){return t.CHM(e),t.oxw().closeForm()}),t._uU(2," Cerrar "),t.qZA()()}}function x(n,c){if(1&n){const e=t.EpF();t.TgZ(0,"li",18)(1,"button",19),t.NdJ("click",function(){return t.CHM(e),t.oxw().closeForm()}),t._uU(2," Cancelar "),t.qZA()()}}function v(n,c){1&n&&(t.TgZ(0,"li",18)(1,"button",20),t._uU(2,"Guardar"),t.qZA()())}var a=(()=>{return(n=a||(a={}))[n.Alta=0]="Alta",n[n.Modificacion=1]="Modificacion",n[n.Detalle=2]="Detalle",a;var n})();let p=(()=>{class n{constructor(e,o,i,r){this.fb=e,this.customerService=o,this.modalActivoRef=i,this.dialogService=r,this.estado=a.Detalle,this.titulo="",this.grupoCustomer=this.fb.group({customerId:[],customerName:[""],customerPhone:[""],customerEmail:[""],customerAddress:[""],customerCity:[""]})}ngOnInit(){this.estado!==a.Alta&&(this.cargarPantalla(),this.estado===a.Detalle&&this.grupoCustomer.disable())}onSubmit(){if(this.grupoCustomer.valid)if(this.customer=this.grupoCustomer.value,this.estado===a.Alta)this.customerService.setCustomer({customer:this.customer}).subscribe({next:e=>{console.log(e),this.closeForm(),this.dialogService.open({title:"Cliente creado",message:"El cliente se ha creado correctamente",tipo:"exito",confirmText:"Aceptar",cancelText:void 0})},error:e=>{console.log(e)}});else{let e={title:"Modificar cliente",message:"\xbfEst\xe1 seguro que desea modificar el cliente seleccionado?",tipo:"advertencia",confirmText:"Aceptar",cancelText:"Cancelar"};this.dialogService.open(e).then(o=>{this.customerService.updateCustomer({customer:this.customer}).subscribe({next:i=>{console.log(i),this.closeForm(),e={title:"Cliente modificado",message:"El cliente se ha modificado correctamente",tipo:"exito",confirmText:"Aceptar",cancelText:void 0},this.dialogService.open(e)},error:i=>{console.log(i)}})})}}cargarPantalla(){this.customer&&this.grupoCustomer.patchValue(this.customer)}closeForm(){this.customer=null,this.modalActivoRef.cerrar()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(l.qu),t.Y36(d.v),t.Y36(C.W),t.Y36(m.x))},n.\u0275cmp=t.Xpm({type:n,selectors:[["cb-ingreso-modificacion"]],decls:38,vars:6,consts:[[1,"cb-main",3,"formGroup","ngSubmit"],[1,"cb-header"],[1,"cb-btn__icon","cb-icon","cb-header__title",2,"margin-right","0.5rem",3,"ngClass"],[1,"cb-header__title",2,"width","100%","text-wrap","nowrap","margin-top","0.1rem"],[1,"cb-section","cb-section--form","cb-form",2,"display","flex","flex-direction","column","row-gap","8px"],[1,"cb-form__section","form-section"],[1,"form-section__content",2,"display","flex","flex-direction","row","flex-wrap","wrap"],[1,"cb-form-field","cb-form-field--inline"],[1,"cb-form-field__label"],["type","text","formControlName","customerName",1,"cb-form-field__input","cb-input","cb-input--small"],["type","text","formControlName","customerEmail",1,"cb-form-field__input","cb-input","cb-input--small"],["type","text","formControlName","customerPhone",1,"cb-form-field__input","cb-input","cb-input--small"],["type","text","formControlName","customerCity",1,"cb-form-field__input","cb-input","cb-input--small"],["type","text","formControlName","customerAddress",1,"cb-form-field__input","cb-input","cb-input--small"],[1,"cb-footer","cb-footer--sticky"],[1,"cb-footer__toolbar","cb-toolbar"],[1,"cb-toolbar__content-fixed"],["class","cb-toolbar__option",4,"ngIf"],[1,"cb-toolbar__option"],["type","button",1,"btn","cb-btn","cb-btn--secondary",3,"click"],["type","submit",1,"btn","cb-btn"]],template:function(e,o){1&e&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return o.onSubmit()}),t.TgZ(1,"header",1),t._UZ(2,"i",2),t.TgZ(3,"h1",3),t._uU(4),t.qZA()(),t.TgZ(5,"section",4)(6,"fieldset",5)(7,"div",6)(8,"div",7)(9,"label",8),t._uU(10,"Nombre"),t.qZA(),t._UZ(11,"input",9),t.qZA()(),t.TgZ(12,"div",6)(13,"div",7)(14,"label",8),t._uU(15,"Mail"),t.qZA(),t._UZ(16,"input",10),t.qZA()(),t.TgZ(17,"div",6)(18,"div",7)(19,"label",8),t._uU(20,"Tel\xe9fono"),t.qZA(),t._UZ(21,"input",11),t.qZA()(),t.TgZ(22,"div",6)(23,"div",7)(24,"label",8),t._uU(25,"Ciudad"),t.qZA(),t._UZ(26,"input",12),t.qZA()(),t.TgZ(27,"div",6)(28,"div",7)(29,"label",8),t._uU(30,"Direcci\xf3n"),t.qZA(),t._UZ(31,"input",13),t.qZA()()()(),t.TgZ(32,"footer",14)(33,"div",15)(34,"div",16),t.YNc(35,h,3,0,"li",17),t.YNc(36,x,3,0,"li",17),t.YNc(37,v,3,0,"li",17),t.qZA()()()()),2&e&&(t.Q6J("formGroup",o.grupoCustomer),t.xp6(2),t.Q6J("ngClass",2===o.estado?"cb-icon--info":1===o.estado?"cb-icon--edit":"cb-icon--add"),t.xp6(2),t.Oqu(o.titulo),t.xp6(31),t.Q6J("ngIf",2===o.estado),t.xp6(1),t.Q6J("ngIf",2!==o.estado),t.xp6(1),t.Q6J("ngIf",2!==o.estado))},directives:[l._Y,l.JL,l.sg,u.mk,l.Fj,l.JJ,l.u,u.O5],styles:[".cb-form-field[_ngcontent-%COMP%]{margin-bottom:8px;width:100%}.cb-form-field__input[_ngcontent-%COMP%]{flex-grow:1}.cb-footer[_ngcontent-%COMP%]{width:88%}"]}),n})();var _=s(4591),M=s(2664);let T=(()=>{class n{constructor(){this.limiteAnterior=0,this.scrollTracker=new t.vpe,this.finalScroll=!1}onScroll(e){if(!this.finalScroll){let o=e.target,i=o.scrollHeight-o.clientHeight;i>this.limiteAnterior&&e.target.scrollTop===i&&(this.adjustScroll(e),this.scrollTracker.emit())}}adjustScroll(e){e.target.scrollTop-=50}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=t.lG2({type:n,selectors:[["","scrollTracker",""]],hostBindings:function(e,o){1&e&&t.NdJ("scroll",function(r){return o.onScroll(r)})},inputs:{finalScroll:"finalScroll"},outputs:{scrollTracker:"scrollTracker"}}),n})();var f=s(8753);function Z(n,c){if(1&n){const e=t.EpF();t.TgZ(0,"button",9)(1,"i",17),t.NdJ("click",function(){return t.CHM(e),t.oxw().limpiarBusqueda()}),t.qZA()()}}function y(n,c){1&n&&(t.TgZ(0,"tr",18)(1,"td",19)(2,"div",20)(3,"div",21),t._UZ(4,"div")(5,"div"),t.qZA()()()())}function A(n,c){1&n&&(t.TgZ(0,"tr",18)(1,"td",19)(2,"div",22)(3,"span",23)(4,"h4")(5,"strong"),t._uU(6,"No hay resultados, por favor verifique la b\xfasqueda"),t.qZA()()()()()())}const O=function(n){return[n]};function P(n,c){if(1&n){const e=t.EpF();t.TgZ(0,"tr",18)(1,"td",19)(2,"div",24)(3,"div",25)(4,"h4")(5,"strong"),t._uU(6),t.qZA()()(),t.TgZ(7,"div",26)(8,"p",27),t._uU(9),t.qZA()(),t.TgZ(10,"div",28)(11,"button",29),t.NdJ("click",function(){const r=t.CHM(e).$implicit;return t.oxw().eliminarCustomer(r)}),t._UZ(12,"span",30),t.qZA(),t.TgZ(13,"button",29),t.NdJ("click",function(){const r=t.CHM(e).$implicit;return t.oxw().editarCustomer(r)}),t._UZ(14,"span",31),t.qZA(),t.TgZ(15,"span")(16,"i",32),t.NdJ("click",function(){const r=t.CHM(e).$implicit;return t.oxw().seleccionarCustomer(r)}),t.qZA()()()()()()}if(2&n){const e=c.$implicit;t.xp6(6),t.Oqu("["+e.customerId+"] "+e.customerName),t.xp6(3),t.hij(" ",e.customerAddress.trim()+" - "+e.customerCity.trim()," "),t.xp6(7),t.Q6J("routerLink",t.VKq(3,O,e?"../../datos-personales/consulta/"+e.customerName:""))}}let k=(()=>{class n{constructor(e,o,i,r){this.modalService=e,this.customerService=o,this.dialogService=i,this.dataService=r,this.customers=[],this.valorActualBuscador="",this.sinDatos=!1,this.buscando=!1,this.cantidadPaginas=40,this.texto="",this.finalScroll=!1}ngOnInit(){this.getCustomers({})}getCustomers({texto:e}){this.buscando=!0,this.customerService.getCustomers().subscribe({next:o=>{if(this.buscando=!1,this.cantidadPaginas+=40,this.sinDatos=!1,this.customers=[...o],e){const i=e.toLowerCase();this.customers=this.customers.filter(r=>r.customerName.toLowerCase().includes(i)||r.customerAddress.toLowerCase().includes(i)||r.customerCity.toLowerCase().includes(i))}0===this.customers.length&&(this.sinDatos=!0),this.finalScroll=o.length<40},error:o=>{console.error(o),this.buscando=!1,this.sinDatos=!0}})}seleccionarCustomer(e){this.dataService.changeData(e)}scrollBottom(){this.getCustomers({texto:this.texto})}limpiarBusqueda(){this.valorActualBuscador="",this.getCustomers({texto:""})}altaCustomer(){const e=this.modalService.abrir(p,{cerrarConClickFueraDelModal:!1});e.instancia.estado=0,e.instancia.titulo="Alta",e.respuesta$.subscribe({next:()=>{},error:()=>{this.getCustomers({})}})}editarCustomer(e){const o=this.modalService.abrir(p,{cerrarConClickFueraDelModal:!1});o.instancia.customer=e,o.instancia.estado=1,o.instancia.titulo="Modificaci\xf3n: "+e.customerName,o.respuesta$.subscribe({next:()=>{},error:()=>{this.getCustomers({})}})}eliminarCustomer(e){let o={title:"Eliminar cliente",message:"\xbfEst\xe1 seguro que desea eliminar el cliente seleccionado?",tipo:"advertencia",confirmText:"Aceptar",cancelText:"Cancelar"};this.dialogService.open(o).then(i=>{i&&this.customerService.deleteCustomer({customerId:e.customerId}).subscribe({next:()=>{this.getCustomers({}),o={title:"Cliente eliminado",message:"El cliente seleccionado ha sido eliminado correctamente.",tipo:"exito",confirmText:"Aceptar",cancelText:void 0},this.dialogService.open(o)},error:()=>{}})})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(_.Z),t.Y36(d.v),t.Y36(m.x),t.Y36(M.D))},n.\u0275cmp=t.Xpm({type:n,selectors:[["cb-consulta"]],decls:19,vars:6,consts:[[1,"body-elements-container"],[1,"cb-header",2,"display","flex","align-items","center","justify-content","space-between"],[1,"cb-header__title"],[2,"display","flex","gap","5px"],[1,"btn","cb-btn","cb-btn--only-icon",2,"color","#9d9d9d","background-color","transparent",3,"click"],[1,"fas","fa-plus"],[1,"cb-section","cb-section--table"],[1,"cb-input-group","cb-input-group--large"],["type","text","placeholder","Ingrese Nombre o C\xf3digo","tabindex","0",1,"cb-input-group__input","cb-input",3,"ngModel","keyup.enter","ngModelChange","click"],[1,"cb-input-group__icon","cb-btn"],[1,"fas","fa-search","input-icon","text-violet"],["class","cb-input-group__icon cb-btn",4,"ngIf"],[1,"cb-section","cb-section--table","cb-section--table__scrollbar-y"],[1,"cb-table","cb-table__tr",3,"finalScroll","scrollTracker"],[1,"cb-table__body"],["class","cb-table__tr",4,"ngIf"],["class","cb-table__tr",4,"ngFor","ngForOf"],[1,"cb-icon","cb-icon--cross",3,"click"],[1,"cb-table__tr"],[1,"cb-table__td"],[1,"cb-card","cb-spinner"],[1,"ball-clip-rotate-multiple"],[1,"cb-card","cb-sin-datos"],[1,"cb-card__subtitle"],[1,"cb-card"],[1,"cb-card__title"],[1,"cb-card__subtitle","pr-4"],[1,"cb-card__subtitle__item"],[1,"cb-toolbar"],[1,"btn","cb-btn","cb-btn--only-icon",2,"color","#9d9d9d","background-color","transparent","cursor","pointer","padding","4px",3,"click"],[1,"cb-menu__icon","cb-icon","cb-icon--delete"],[1,"cb-menu__icon","cb-icon","cb-icon--edit"],["type","button",1,"fas","fa-chevron-right","text-violet",2,"display","flex","justify-content","space-between","align-items","center","cursor","pointer",3,"routerLink","click"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"header",1)(2,"h1",2),t._uU(3,"Cliente"),t.qZA(),t.TgZ(4,"div",3)(5,"button",4),t.NdJ("click",function(){return o.altaCustomer()}),t._UZ(6,"i",5),t.qZA()()()(),t.TgZ(7,"section",6)(8,"div",7)(9,"input",8),t.NdJ("keyup.enter",function(){return o.getCustomers({texto:o.valorActualBuscador})})("ngModelChange",function(r){return o.valorActualBuscador=r})("click",function(){return o.getCustomers({texto:o.valorActualBuscador})}),t.qZA(),t.TgZ(10,"button",9),t._UZ(11,"i",10),t.qZA(),t.YNc(12,Z,2,0,"button",11),t.qZA()(),t.TgZ(13,"section",12)(14,"table",13),t.NdJ("scrollTracker",function(){return o.scrollBottom()}),t.TgZ(15,"tbody",14),t.YNc(16,y,6,0,"tr",15),t.YNc(17,A,7,0,"tr",15),t.YNc(18,P,17,5,"tr",16),t.qZA()()()),2&e&&(t.xp6(9),t.Q6J("ngModel",o.valorActualBuscador),t.xp6(3),t.Q6J("ngIf",o.valorActualBuscador),t.xp6(2),t.Q6J("finalScroll",o.finalScroll),t.xp6(2),t.Q6J("ngIf",o.buscando),t.xp6(1),t.Q6J("ngIf",o.sinDatos),t.xp6(1),t.Q6J("ngForOf",o.customers))},directives:[l.Fj,l.JJ,l.On,u.O5,T,u.sg,f.rH],styles:["input[_ngcontent-%COMP%]{padding:10px;font-size:16px}.cb-input-group[_ngcontent-%COMP%]{background:#fff}.cb-input-group[_ngcontent-%COMP%]   .cb-btn[_ngcontent-%COMP%]{border:none!important}.cb-table[_ngcontent-%COMP%]   .cb-table__tr[_ngcontent-%COMP%]{background-color:#fff}.cb-table[_ngcontent-%COMP%]   .cb-table__tr[_ngcontent-%COMP%]:hover{background-color:#fff!important}.cb-section--table[_ngcontent-%COMP%]{overflow:hidden;padding:2px;width:100%;margin:6px auto;max-width:800px;background-color:transparent}.cb-section--table[_ngcontent-%COMP%]   .cb-card__title[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%], .cb-section--table[_ngcontent-%COMP%]   .cb-card__subtitle[_ngcontent-%COMP%]{font:14.4px Source Sans Pro,sans-serif}.cb-section--table[_ngcontent-%COMP%]   .cb-card__subtitle[_ngcontent-%COMP%]{color:#646464}.cb-section--table[_ngcontent-%COMP%]   .cb-card__title[_ngcontent-%COMP%]   P[_ngcontent-%COMP%]{font-size:16px}.cb-table__tr[_ngcontent-%COMP%]{border-bottom:1px solid #ddd}.cb-card[_ngcontent-%COMP%]{padding:0;position:relative}.cb-toolbar[_ngcontent-%COMP%]{position:absolute;right:10px;top:50%;transform:translateY(-50%);font-size:1em}.cb-toolbar[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#55c1e6;display:flex;align-items:center;justify-content:center}.cb-section--table__scrollbar-y[_ngcontent-%COMP%]{max-height:calc(110vh - 13rem);overflow-y:auto;overflow-x:hidden}.cb-card__title[_ngcontent-%COMP%]{flex-direction:row;justify-content:space-between}@media (max-width: 429.98px){.cb-card__title[_ngcontent-%COMP%]{flex-direction:column}}.cb-spinner[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:calc(107vh - 13rem);margin:0}.cb-sin-datos[_ngcontent-%COMP%]{height:100px;align-items:center;justify-content:center;margin:0}.ball-clip-rotate-multiple[_ngcontent-%COMP%]{position:relative}.ball-clip-rotate-multiple[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{animation-fill-mode:both;position:absolute;border:2px solid #55c1e6;border-bottom-color:transparent;border-top-color:transparent;border-radius:100%;height:55px;width:55px;animation:rotate 1s 0s ease-in-out infinite}.ball-clip-rotate-multiple[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-child{bottom:-3rem;left:.5rem;display:inline-block;width:35px;height:35px;animation-duration:.5s;border-color:#55c1e6 transparent #55c1e6 transparent;animation-direction:reverse}@keyframes rotate{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.cb-section--table__scrollbar-y[_ngcontent-%COMP%]::-webkit-scrollbar{width:12px}.cb-section--table__scrollbar-y[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#888;border:2px solid #fff;border-radius:6px}.cb-section--table__scrollbar-y[_ngcontent-%COMP%]::-webkit-scrollbar-track{background-color:#f1f1f1}.cb-icon.cb-icon--agenda[_ngcontent-%COMP%], .text-primary[_ngcontent-%COMP%]{color:#55c1e6!important}.text-violet[_ngcontent-%COMP%]{color:#9b91d9!important}.cb-card__title[_ngcontent-%COMP%]{flex-direction:row;justify-content:space-between;display:flex;font-size:18px;margin:0;color:#55c1e6}.cb-table__td[_ngcontent-%COMP%]{border-bottom:1px solid #ddd;font-size:24px!important}"]}),n})();var S=s(520),w=s(6211);const N=[{path:"consulta",component:k}];let J=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[d.v,_.Z,m.x],imports:[[u.ez,l.u5,l.UX,S.JF,f.Bz.forChild(N),w.s]]}),n})()}}]);